using System;
using System.Collections.Generic;
using System.Linq;

namespace AdventOfCode2017
{
  public class Day19Part1 : ISolution
  {

    public enum MazeDirection
    {
      Down,
      Right,
      Left,
      Up
    }
    public int Solve()
    {
      // Parse the map and work out where we're going
      var map = Input.SplitByNewLines().Skip(1).Select(line => line.ToCharArray()).ToArray();
      int currentColumn = Array.IndexOf(map[0], '|');
      int currentRow = 0;
      MazeDirection direction = MazeDirection.Down;
      var lettersFound = new List<char>();

      while (true)
      {
        if (currentRow < 0 || currentRow >= map.Length || currentColumn < 0 || currentColumn >= map[currentRow].Length)
        {
          // We've run off the edge - hopefully we're done.
          Console.WriteLine($"Solution: {string.Join("", lettersFound.ToArray())}");
          return 42;
        }

        if (map[currentRow][currentColumn] >= 'A' && map[currentRow][currentColumn] <= 'Z')
        {
          // Woo, found a letter!
          var foundLetter = map[currentRow][currentColumn];

          if (lettersFound.Contains(foundLetter))
          {
            // Uh oh, we assume this is wrong; what shall we try doing?
            Console.WriteLine($"Oops, found {foundLetter} again; reverse direction!");
            switch (direction)
            {
              case MazeDirection.Up:
                direction = MazeDirection.Down;
                break;
              case MazeDirection.Down:
                direction = MazeDirection.Up;
                break;
                case MazeDirection.Left:
                direction=MazeDirection.Right;
                break;
                case MazeDirection.Right:
                direction = MazeDirection.Left;
                break;
            }
          }
          else
          {
            lettersFound.Add(foundLetter);
          }
        }

        Console.WriteLine($"Going {direction} at {currentRow}, {currentColumn} having found {string.Join("", lettersFound.ToArray())}");
        switch (direction)
        {
          case MazeDirection.Down:
            // Base case: Assume we were already heading down via a sensible route, either a | or a letter or crossing over a - or something. So we
            // want to continue down unless we're o a + and going straight on will land us over the edge or on an empty space
            if ((currentRow == map.Length - 1 || map[currentRow+1][currentColumn] == ' ') && map[currentRow][currentColumn] == '+')
            {
              // This is the "about to do something silly, but we can turn a corner so we're ok" case
              if (currentColumn > 0 && (map[currentRow][currentColumn - 1] == '-' || (map[currentRow][currentColumn - 1] >= 'A' && map[currentRow][currentColumn - 1] <= 'Z')))
              {
                currentColumn--;
                direction = MazeDirection.Left;
              }
              else if (currentColumn < map[currentRow].Length-1 && (map[currentRow][currentColumn + 1] == '-' || (map[currentRow][currentColumn+1] >= 'A' && map[currentRow][currentColumn+1] <= 'Z')))
              {
                currentColumn++;
                direction = MazeDirection.Right;
              }
              else
              {
                throw new InvalidOperationException(
                  "Oops, looks like we can and should turn a corner, but we can't, which is suspicious");
              }
            }
            else
            {
              {
                // We can keep heading down, so let's do it
                currentRow++;
              }
            }
            break;

            case MazeDirection.Up:
            // BIG COMMENT TO MISS LATER: This should be identical to the DOWN case, but inverted
            // Base case: Assume we were already heading up via a sensible route, either a | or a letter or crossing over a - or something. So we
            // want to continue down unless we're o a + and going straight on will land us over the edge or on an empty space
            if ((currentRow == 0 || map[currentRow - 1][currentColumn] == ' ') && map[currentRow][currentColumn] == '+')
            {
              // This is the "about to do something silly, but we can turn a corner so we're ok" case
              if (currentColumn > 0 && (map[currentRow][currentColumn - 1] == '-' || (map[currentRow][currentColumn - 1] >= 'A' && map[currentRow][currentColumn - 1] <= 'Z')))
              {
                currentColumn--;
                direction = MazeDirection.Left;
              }
              else if (currentColumn < map[currentRow].Length && (map[currentRow][currentColumn + 1] == '-' || (map[currentRow][currentColumn + 1] >= 'A' && map[currentRow][currentColumn + 1] <= 'Z')))
              {
                currentColumn++;
                direction = MazeDirection.Right;
              }
              else
              {
                throw new InvalidOperationException(
                  "Oops, looks like we can and should turn a corner, but we can't, which is suspicious");
              }
            }
            else
            {
              {
                // We can keep heading up, so let's do it
                currentRow--;
              }
            }
            break;

          case MazeDirection.Left:
            // BIG COMMENT TO MISS LATER: This should be very similar to the DOWN case, but rotated somehow
            // Base case: Assume we were already heading left via a sensible route, either a - or a letter or crossing over a | or something. So we
            // want to continue left unless we're on a + and going straight on will land us over the edge or on an empty space
            if ((currentColumn == 0 || map[currentRow][currentColumn-1] == ' ') && map[currentRow][currentColumn] == '+')
            {
              // This is the "about to do something silly, but we can turn a corner so we're ok" case
              if (currentRow > 0 && (map[currentRow-1][currentColumn] == '|' || (map[currentRow-1][currentColumn] >= 'A' && map[currentRow-1][currentColumn] <= 'Z')))
              {
                currentRow--;
                direction = MazeDirection.Up;
              }
              else if (currentRow < map.Length-1 && (map[currentRow+1][currentColumn] == '|' || (map[currentRow + 1][currentColumn] >= 'A' && map[currentRow + 1][currentColumn] <= 'Z')))
              {
                currentRow++;
                direction = MazeDirection.Down;
              }
              else
              {
                throw new InvalidOperationException(
                  "Oops, looks like we can and should turn a corner, but we can't, which is suspicious");
              }
            }
            else
            {
              {
                // We can keep heading left, so let's do it
                currentColumn--;
              }
            }
            break;

          case MazeDirection.Right:
            // BIG COMMENT TO MISS LATER: This should be very similar to the LEFT case, but inverted
            // Base case: Assume we were already heading right via a sensible route, either a - or a letter or crossing over a | or something. So we
            // want to continue right unless we're on a + and going straight on will land us over the edge or on an empty space
            if ((currentColumn == map[currentRow].Length-1 || map[currentRow][currentColumn + 1] == ' ') && map[currentRow][currentColumn] == '+')
            {
              // This is the "about to do something silly, but we can turn a corner so we're ok" case
              if (currentRow > 0 && (map[currentRow - 1][currentColumn] == '|' || (map[currentRow-1][currentColumn] >= 'A' && map[currentRow-1][currentColumn] <= 'Z')))
              {
                currentRow--;
                direction = MazeDirection.Up;
              }
              else if (currentRow < map.Length-1 && (map[currentRow + 1][currentColumn] == '|' || (map[currentRow + 1][currentColumn] >= 'A' && map[currentRow + 1][currentColumn] <= 'Z')))
              {
                currentRow++;
                direction = MazeDirection.Down;
              }
              else
              {
                throw new InvalidOperationException(
                  "Oops, looks like we can and should turn a corner, but we can't, which is suspicious");
              }
            }
            else
            {
              {
                // We can keep heading right, so let's do it
                currentColumn++;
              }
            }
            break;

        }
      }


      return 42;
    }

    private static string TestInput = @"
     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+";

    private static string Input = @"
                                                       |                                                                                                                                                 
 +---+       +-+ +-------------------------------------|-------------------------------------------------------------+     +-------------------------------------------------------------------+         
 |   |       | | |                                     |                                                             |     |                                                                   |         
 | +-|-------|-------------------------------------------------------------------------------------------------------|---------------+             +-------------------------+     +-+       +-+         
 | | |       | | |                                     |                                                             |     |         |             |                         |     | |       |           
 | | | +-----|-|-+ +---+ +-------------------------------------+       +-----------------------+       +-------------------|---------+           +-|---+         +-+     +---------+ |       |   +---+   
 | | | |     | |   |   | |                             |       |       |                       |       |             |     |                     | |   |         | |     |   |       |       |   |   |   
 | | | |     | |   |   | |             +---------------|---------------+ +---------------------|---------------------|---------+     +-----------|-|-+ |         | |   +-+   |     +-|-------|-------+   
 | | | |     | |   |   | |             |               |       |         |                     |       |             |     |   |     |           | | | |         | |   |     |     | |       |   |       
 | | | |     | | +-------|-------------|---------------|-------|-+ +-----+ +-------------------|---------------------------|---------|---------------|-|---------|-----------------|-|-------+   |       
 | | | |     | | | |   | |             |               |       | | |       |                   |       |             |     |   |     |           | | | |         | |   |     |     | |           |       
 | | +-|-------|---|-+ | | +-----------|-----------------------------------|---------------------------+             |     |   |     |           | | | |         | |   |     |     | |           |       
 | |   |     | | | | | | | |           |               |       | | |       |                   |                     |     |   |     |           | | | |         | |   |     |     | |           |       
 | | +-|-------|-------|-|-|---------+ |               |   +---|-|---------------------------------------------------|---------|-----------------|-----|---------|-|---------|---------------------+     
 | | | |     | | | | | | | |         | |               |   |   | | |       |                   |                     |     |   |     |           | | | |         | |   |     |     | |           | |     
 | | | |   +-|-----|-|---------------------------------|---------|---------------+ +---+       |         +-----------|-----|---------|---+       | | | |         | |   |     |     | |           | |     
 | | | |   | | | | | | | | |         | |               |   |   | | |       |     | |   |       |         |           |     |   |     |   |       | | | |         | |   |     |     | |           | |     
 | | | |   | | | | | | +-|-|-------------------------------|---+ | |     +-------|-----|-----------------------------|-----|---|-----|---+       | | | |         | |   |     |     | |           | |     
 | | | |   | | | | | |   | |         | |               |   |     | |     | |     | |   |       |         |           |     |   |     |           | | | |         | |   |     |     | |           | |     
 | | | |   | | | | | |   | |         | |               |   |     | +-------|-----------------------------|---------------------------|---------------------------|-----------|---------------------|-+   
 | | | |   | | | | | |   | |         | |               |   |     |       | |     | |   |       |         |           |     |   |     |           | | | |         | |   |     |     | |           | | |   
 | | | |   | | | | | |   | |         | +---------------|---|-+   |     +---|---+ | |   +-------|-----+   +-----------|---------------+           | | +-----------|-|---|---------------------------|-+   
 | | | |   | | | | | |   | |         |                 |   | |   |     | | |   | | |           |     |               |     |   |                 | |   |         | |   |     |     | |           | |     
 | | | |   | | | | | |   | |         |                 |   +-|-------------------|-|---------------------+           |     |   |                 +-----|---+     | |   |     |     +-----------+ | |     
 | | | |   | | | | | |   | |         |                 |     |   |     | | |   | | |           |     |   |           |     |   |                   |   |   |     | |   |     |       |         | | |     
 | | | |   | | | | +-|-------------+ |         +---------+   |   +-------|-----|-|-|-----------|-----|---|---------------------|---------------------+ |   +-----|-|---------------------------|-|-|---+ 
 | | | |   | | | |   |   | |       | |         |       | |   |         | | |   | | |           |     |   |           |     |   |                   | | |         | |   |     |       |         | | |   | 
 | | | |   | | | |   |   | |       | |         +-----+ | +---------------|-------|---+         |     |   |           |     |   |                   | | |         | |   +-+   |       |         | | +---+ 
 | | | |   | | | |   |   | |       | |               | |     |         | | |   | | | |         |     |   |           |     |   |                   | | |         | |     |   |       |         | |       
 | | | +-----|-|-|-----------------|-|---------------|-|-----|---------|-|-|-----+ | |         |     |   | +---------------|---|-------------------|-|-----------+ |     |   |       |         | |       
 | | |     | | | |   |   | |       | |               | |     |         | | |   |   | |         |     |   | |         |     |   |                   | | |           |     |   |       |         | |       
 | | |     | | | | +-------|-------|-------------------------------------|-|---|---|---------+ |     |   | |         |     |   |                   +-------------------+ |   |       +---+ +---|-|-+     
 | | |     | | | | | |   | |       | |               | |     |         | | |   |   | |       | |     |   | |         |     |   |                     | |           |   | |   |           | |   | | |     
 | | |     | | | | | |   | |       | |         +-------|-----|---------|---|---|-----|-------+ |     +---------------------|---+                     | |           |   | |   |           | |   | | |     
 | | |     | | | | | |   | |       | |         |     | |     |         | | |   |   | |         |         | |         |     |                         | |           |   | |   |           | |   | | |     
 | | |     | | | | | |   | |       | |         |     | |     |         | | |   |   | |         |         | |         |     |                         | |       +---+   | |   |   +---------------+ |     
 | | |     | | | | | |   | |       | |         |     | |     |         | | |   |   | |         |         | |         |     |                         | |       |       | |   |   |       | |   |   |     
 | | |     | | | | | |   | |       | |         |   +-|-|-------------------|---------|---------|-+       | |         |     |                         | |       |   +-----|-------+       | |   |   | +-+ 
 | | |     | | | | | |   | |       | |         |   | | |     |         | | |   |   | |         | |       | |         |     |                         | |       |   |   | |   |           | |   |   | | | 
 +-|-------|-------|-|---------------|---------|---|-------------------------------|-----------|---------------------------|-----------------------+ | |       |   |   | |   |           | |   |   | | | 
   | |     | | | | | |   | |       | |         |   | | |     |         | | |   |   | |         | |       | |         |     |                       | | |       |   |   | |   |           | |   |   | | | 
   | |     | | | | | |   | |       | |         | +-------+   |   +-----|-------|-----|---------|---------|-|---------------------------------------|-|---------+   |   | |   |           | |   |   | | | 
   | |     | | | | | |   | |       | |         | | | | | |   |   |     | | |   |   | |         | |       | |         |     |                       | | |           |   | |   |           | |   |   | | | 
   | |     | | | | | |   | |       +-|---------|---|-|---|---|---+   +---|-----|---|---------------------------------|-------------------------------+ |           |   | |   |           | |   |   | | | 
   | |     | | | | | |   | |         |         | | | | | |   |       | | | |   |   | |         | |       | |         |     |                       |   |           |   | |   |           | |   |   | | | 
   | |     | | | | | |   | +-+       |   +-----------|---|---|-----------------------------------|---------|---------|-----------------------------|---------------|-----|---------+ +---|-------+ | | | 
   | |     | | | | | |   |   |       |   |     | | | | | |   |       | | | |   |   | |         | |       | |         |     |                       |   |           |   | |   |     | |   | |   | | | | | 
   | |     | | | | | |   |   |       |   | +---|---------|---|-------|-|-|-|-------|-|---+     | |       | |         |     |                       |   |           |   | |   |     | |   | |   | | +-+ | 
   | |     | | | | | |   |   |       |   | |   | | | | | |   |       | | | |   |   | |   |     | |       | |         |     |                       |   |           |   | |   |     | |   | |   | |     | 
   | |     | | | | | |   |   |       |   | |   | | | | | |   |       | | | |   |   | |   |     | |       | |         |     |                       |   |           |   | |   |     | |   | |   | |     | 
   | |     | | | | | |   |   |       |   | |   | | | | | |   |       | | | |   |   | |   |     | |       | |         |     |                       |   |           |   | |   |     | |   | |   | |     | 
   | |     | | | | | |   |   |       |   | |   +-|-|-|-|-|----G------|---|-------+ +-------------|-------|---------------------------------------------------------|-----|-------+ | |   | |   | |     | 
   | |     | | | | | |   |   |       |   | |     | | | | |   |       | | | |   | |   |   |     | |       | |         |     |                       |   |           |   | |   |   | | |   | |   | |     | 
   | |     | | | | | |   |   |       |   | |     | +-|-----------------|-|-|---+ | +-----------|---------|-|---------|-----|---------------------------|-----------------|-----------------|-----|-+   | 
   | |     | | | | | |   |   |       |   | |     |   | | |   |       | | | |     | | |   |     | |       | |         |     |                       |   |           |   | |   |   | | |   | |   | | |   | 
   | |     | | | | | |   |   |       |   | |     |   | | +-----------|---+ |     | | |   |     | |       | |         |     |                       |   |           |   | |   |   | | |   | |   | | |   | 
   | |     | | | | | |   |   |       |   | |     |   | |     |       | |   |     | | |   |     | |       | |         |     |                       |   |           |   | |   |   | | |   | |   | | |   | 
   | |     | | | | +-|---+   |       |   | |     |   | | +---|-+ +---------|---------|-+ |     | |       +-----------|-------+                     |   |       +---|---|-------+ +-------|-----|---|-+ | 
   | |     | | | |   |       |       |   | |     |   | | |   | | |   | |   |     | | | | |     | |         |         |     | |                     |   |       |   |   | |   | |   | |   | |   | | | | | 
   | |     | | | |   |       |       |   | |     | +---|-----|-|-------|-----------------------+ |         |         |     | |                     |   |       |   |   | |   | |   | |   | |   | | | | | 
   | |     | | | |   |       |       |   | |     | | | | |   | | |   | |   |     | | | | |       |         |         |     | |                     |   |       |   |   | |   | |   | |   | |   | | | | | 
   | | +---|-|-|-----|-------|-------|---|-----------|---|---|---|---|-------------|-|---|-----------------|---------|-------------------------------------------------|-------|---|-+   | |   | | | | | 
   | | |   | | | |   |       |       |   | |     | | | | |   | | |   | |   |     | | | | |       |         |         |     | |                     |   |       |   |   | |   | |   |     | |   | | | | | 
   | | |   | | | |   |       |       |   | +-------|-|-+ |   | | |   | |   |     | | | | |       +-------------------|-----|--O------------------------|-------|---|-----|---|-----|-----+ |   | | | | | 
   | | |   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |                 |         |     | |                     |   |       |   |   | |   | |   |       |   | | | | | 
   | +-+   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               +-|---------|-----|-------+               |   |       |   |   | |   | | +-------+ | Y | | | | | 
   |       | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | |     | | | | | | | | 
   |       | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | |     | | | | | | | | 
   |       | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | |     | | | | | | | | 
   |   +---|-|-|-|-----------|-------|-------------|---------|---|-----|---|-----|-|---|-----------------|-|-----------------|---------------------|-----------|-------|-|---|--N--|-+   | | | | | | | | 
   |   |   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | | |   | | | | | | | | 
   |   |   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | | |   | | | +-+ | | | 
   |   |   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |               | |         |     | |     |               |   |       |   |   | |   | | | | |   | | |     | | | 
   | +-----|-|-------|---------------------------|-------|-----|-|---|-|---------------|-|-----+         | |         |     | |     |               |   |       |   |   | |   +-|-|-|---+ | | |     | | | 
   | | |   | | | |   |       |       |   |       | | |   |   | | |   | |   |     | | | | |     |         | |         |     | |     |               |   |       |   |   | |     | | | | | | | |     | | | 
   | | | +-|-|-----------------------------------|-|-+   |   | | |   | |   |     | | | | |     |         | |         |     | |     |               |   |       |   |   | |     | | | | | | | |     | | | 
   | | | | | | | |   |       W       |   |       | |     |   | | |   | |   |     | | | | |     |         | |         |     | |     |               |   |       |   |   | |     | | | | | | | |     | | | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | | | | |     |         | |         |     | |     |               |   |       |   |   | |     | | | | | | | |     | | | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | | | | |     |         | |         |     | |     |               |   |       |   |   | |     | | | | | | | |     | | | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | | +-------------------|-|-------+ |     | |     |               |   | +-----|---------|-------|-|-----|---|-----|-+ | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | |   | |     |         | |       | |     | |     |               |   | |     |   |   | |     | | | | | | | |     |   | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | |   | |     |         | |       | |     | |     |               |   | |     |   |   | |     | | | | | | | |     |   | 
   | | | | | | | |   |       |       |   |       | |     |   | | |   | |   |     | |   | |     |         | |       | |     | |     |               |   | |     |   |   | |     | | | | | | | |     |   | 
   | | | | | | | |   |   +---|------------B--------+ +-----------+   | |   |     | |   | |     |         +-|-------+ |     | |     |               |   | |     |   +---|-|---+ | | | | | | | |     |   | 
   | | | | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |     |               |   | |     |       | |   | | | | | | | | |     |   | 
   | | +-|-|-|---|-------|---|-----------------------|-------|-------|-----|-----|-------|-----|---------------------|-------|---+ |               |   | |     |       | |   | | | | | | | | |     |   | 
   | |   | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |   | |               |   | |     |       | |   | | | | | | | | |     |   | 
   | |   | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |   | |       +-------------|-----|-------|---------|-----------+     |   | 
   | |   | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |   | |       |       |   | |     |       | |   | | | | | | | |       |   | 
   | |   | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |   +-|-------|-------|---|-|-----|-----+ +-+   | | | | | | | |       |   | 
   | |   | | | | |   |   |   |       |   |       |   |   |   | |     | |   |     | |   | |     |           |         |     | |     |       |       |   | |     |     |       | | | | | | | |       |   | 
   | |   | +---|-|---|-------|-----+ |   |       |   |   |   | |     | |   |     | |   | |     |           |     +-------+ +-----+ |       |       |   | |     |     | +-----|---+ | | | +-----------+ | 
   | |   |   | | |   |   |   |     | |   |       |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |   | |       |       |   | |     |     | |     | |   | | |   |       | | | 
   | | +-|-+ | | |   |   |   +-----|-|---|---------------------|-------|---------------|-|-----|---------------------------------+ |       |       |   | |     |     | |   +---------|---+ |       | | | 
   | | | | | | | |   |   |         | |   |       |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | | | | |       | | | 
   | | | | | | | |   |   |         | |   |   +-------|---------------|-|---|-------|-----------------------|-----|-------|---------|-------|-----------|-|-----------------|-----------|-+ |       | | | 
   | | | | | | | |   |   |         | |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | | |   |       | | | 
   | | | | | | | |   |   |         +-|-------|---|-------------------------------|-----|-------------------------|-------|---|-----|---------------------------|-----|-------------|---------------|-+ | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | | |   |       |   | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | | +-------+   |   | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | |     |   |   |   | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | |     |   |   |   | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | |     |   |   |   | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | |     |   +-----+ | 
   | | | | | | | |   |   |           |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |       |   | |     |     | |   | | |   | |     |       | | | 
   | | | | | | | | +-|-+ | +---------|---|-------|---|-------|-------|-----|-----|-----|-|-----|-----------------|-------------------------|-------+   | |     |     | |   | | |   | |     |       | | | 
   | | | | | | | | | | | | |         |   |   |   |   |   |   | |     | |   |     | |   | |     |           |     |   |   |   |     |       |           | |     |     | |   | | |   | |     |       | | | 
   | | | | | | | | | | | | |         |   |   |   +-------|---|-|-------+   |     | |   | |     |         +-|-----|---|-------------|-------------------|-|-----|-----|-----+ | |   | |     | +-------+ | 
   | | | | | | | | | | | | |         |   |   |       |   |   | |     |     |     | |   | |     |         | |     |   |   |   |     |       |           | |     |     | |     | |   | |     | |     |   | 
   | | | | | | | | | | | | |         |   |   |       |   |   | |     |     |     +-|-----------|---------+ |     |   |   |   |     |       |     +-----|-----+ |     | |     | |   | |     | |     |   | 
   | | | | | | | | | | | | |         |   |   |       |   |   | |     |     |       |   | |     |           |     |   |   |   |     |       |     |     | |   | |     | |     | |   | |     | |     |   | 
   | | | | | | | | | | | | |         |   |   |     +-|---|---|-------|-----------------|-|-----|-----------|-----|---|---|-----------------+     | +---|-----|-|---+ | |     | |   | |     | |     |   | 
   | | | | | | | | | | | | |         |   |   |     | |   |   | |     |     |       |   | |     |           |     |   |   |   |     |             | |   | |   | |   | | |     | |   | |     | |     |   | 
   | | | | | | | | | | | | |         |   |   +-----|-----------|-----------|-------|---|-|-----|---------------------|-------------|---------------------------|---------------|---+ |     | |     |   | 
   | | | | | | | | | | | | |         |   |         | |   |   | |     |     |       |   | |     |           |     |   |   |   |     |             | |   | |   | |   | | |     | |     |     | |     |   | 
   | | | | | | | | | | | | |       +-|-+ |         | |   |   | |     |     |       |   | |     |   +-------------|-----------|---------------------------|---|-|-+ +-|-|-----|-|---+ |   +-|-+     |   | 
   | | | | | | | | | | | | |       | | | |         | |   |   | |     |     |       |   | |     |   |       |     |   |   |   |     |             | |   | |   | | |   | |     | |   | |   | |       |   | 
   +-|-------+ | | | | | | |       | | | |         | | +-+   | |     |     |       |   | |     |   |       |     |   |   |   |     |             | |   | |   | | |   | |     | |   | |   | |       |   | 
     | | | |   | | | | | | |       | | | |         | | |     | |     |     |       |   | |     |   |       |     |   |   |   |     |             | |   | |   | | |   | |     | |   | |   | |       |   | 
 +---|-|-|---------|-|-|-|-|-------------|-------------|-------|-------------------|---|-|-------+ |       |     |   |   |   |     |             | |   | |   | | |   | |     | |   | |   | |       |   | 
 |   | | | |   | | | | | | |       | | | |         | | |     | |     |     |       |   | |     | | |       |     |   |   |   |     |             | |   | |   | | |   | |     | |   | |   | |       |   | 
 +-+ | | | |   | | | | | | |       | | | |         | +---+ +-|-|-----|-----------------|-----------------------------|-------|-----|-------------------|---------|-+ | |     | |   | |   | |       |   | 
   | | | | |   | | | | | | |       | | | |         |   | | | | |     |     |       |   | |     | | |       |     |   |   |   |     |             | |   | |   | | | | | |     | |   | |   | |       |   | 
 +-|---|---|-----|-|---|-------------|-----------------|-|-+ | |     |     |       |   | |     | | |       |     |   |   |   |     |             | +-----+ +-----|-+ +-|-------------|---|-+       |   | 
 | | | | | |   | | | | | | |       | | | |         |   | |   | |     |     |       |   | |     | | |       |     |   |   |   |     |             |     |   | | | |     |     | |   | |   |         |   | 
 | | | | | |   | | | | | | |   +-----|-----+       |   | |   +-------|-------------------|-----------------------|---|---|---|-----|-------------|-----+   +-+ | |     |     | |   | |   |         |   | 
 | | | | | |   | | | | | | |   |   | | | | |       |   | |     |     |     |       |   | |     | | |       |     |   |   |   |     |             |             | |     |     | |   | |   |         |   | 
 | | | | | | +-|-|-|-|-|-|-|M--+   | | | | +-------+   | |   +-------|-----|-------|-----------|---------------------|---|---|-----------------------------------------|-----|-----------|-----+   |   | 
 | | | | | | | | | | | | | |       | | | |             | |   | |     |     |       |   | |     | | |       |     |   |   |   |     |             |             | |     |     | |   | |   |     |   |   | 
 | | | | | | | | | | | | | |     +-|-|-|-|-------------|-----|-------------|-------|---|-|---------|-------|-----|---------------------------------+           | |     |     | |   | |   |     |   |   | 
 | | | | | | | | | | | | | |     | | | | |             | |   | |     |     |       |   | |     | | |       |     |   |   |   |     |             | |           | |     |     | |   | |   |     |   |   | 
 | +-----|-|-----|-|-|---|-|-----|-------|-+   +---------+   +-|-----------|-------------------|-+ |       |     |   |   |   |     |             | |           | |     |     | +---|-----------|---+   | 
 |   | | | | | | | | | | | |     | | | | | |   |       |       |     |     |       |   | |     |   |       |     |   |   |   |     |             | |           | |     |     |     | |   |     |       | 
 |   | | | | | | | | | | | |     | | | | +-|---|---------------------------|-----------|-----------|-------|-----|---|---|-------------------------------------|-------|---------------+ |     |       | 
 |   | | | | | | | | | | | |     | | | |   |   |       |       |     |     |       |   | |     |   |       |     |   |   |   |     |             | |           | |     |     |     | | | |     |       | 
 |   | | | | | | | | | | | |     | | | |   |   |       | +-----|-----|-----|-----------|-|-----------------|-----+   |   +---|-----|-------------|-|-------------|---------------------|---+ +---+     | 
 |   | | | | | | | | | | | |     | | | |   |   |       | |     |     |     |       |   | |     |   |       |         |       |     |             | |           | |     |     |     | | | | | | | |     | 
 |   | +-|---+ | | | | | | |     | | +-|-------------+ +-|-----|-----+     |       |   | |     |   +-------------------------|---------------------|-----------|-|-----|-----------|---|-|---|-|-|-+   | 
 |   |   | |   | | | | | | |     | |   |   |   |     |   |     |           |       |   | |     |           |         |       |     |             | |           | |     |     |     | | | | | | | | |   | 
 |   |   | |   | | | | | | |     | |   |   |   |     |   |     |           |       |   | |     |           |         |       |     |             | |           | |     |     |     | | | | | +-|---|-+ | 
 |   |   | |   | | | | | | |     | |   |   |   |     |   |     |           |       |   | |     |           |         |       |     |             | |           | |     |     |     | | | | |   | | | | | 
 |   +-+ | |   | | | | | | | +---|-|-----------------|---------------------|-----------|-|---+ |           |         |       |     |             | |           | |     |     |     | | | | |   | | | | | 
 |     | E |   | | | | | | | |   | |   |   |   |     |   |     |           |       |   | |   | |           |         |       |     |             | |           | |     |     |     | | | | |   | | | | | 
 |     | | +-------|-|-|---|-----|---+ |   |   |     |   |     |           |       |   | |   | |           +-----------------|-----------------------+         | |     |     |     | | | | |   | | | | | 
 |     | |     | | | | | | | |   | | | |   |   |     |   |     |           |       |   | |   | |                     |       |     |             | | |         | |     |     |     | | | | |   | | | | | 
 |     | | +---------------+ |   | | | |   |   |     +-------+ |           |       |   | |   | | +-------------------|-------------+             | | |         | +---+ |     |     | | | | |   | | | | | 
 |     | | |   | | C | | |   |   | | | |   |   |         |   | |           |       |   | |   | | |                   |       |                   | | |         |     | |     |     | | | | |   | | | | | 
 |     | | |   | | | | | |   |   | | | |   |   | +-----------|-------------------------|-----+ | |                   |       |                   | | |         |     | |     |     | | | | |   | | | | | 
 |     | | |   | | | | | |   |   | | | |   |   | |       |   | |           |       |   | |     | |                   |       |                   | | |         |     | |     |     | | | | |   | | | | | 
 |     | | |   | | | | | |   |   | | | |   |   | |       |   | |           |       |   +-------|-----------------------------|-------------------|---|-----+   |     | |     |     +-|-|-|---+ | | | | | 
 |     | | |   | D | | | |   |   | | | |   |   | |       |   | |           |       |     |     | |                   |       |                   | | |     |   |     | |     |       | | | | | | | | | | 
 |     | | |   | | | | | |   |   | +-+ |   | +-+ |       |   | |           |       |     |     | |                   |       |                   | | |     |   |     | |     |       | | | | | | | | | | 
 |     | | |   | | | | | |   |   |     |   | |   |       |   | |           |       |     |     | |                   |       |                   | | |     |   |     | |     |       | | | | | | | | | | 
 |     | | |   | | | | | |   |   |     |   | | +---+ +-------|-------------|-------------|---------------------------|-------------------------------+     +---|-------|-----|-------|-------+ | | | | | 
 |     | | |   | | | | | |   |   |     |   | | | | | |   |   | |           |       |     |     | |                   |       |                   | |           |     | |     |       | | | |   | | | | | 
 |     | +-----|-----+ | |   |   |     |   | | | | | | +-|---|---------------------------------|-----------------------------+                   | |           |     | |     |       | +-----+ | | | | | 
 |     |   |   | | |   | |   |   |     |   | | | | | | | |   | |           |       |     |     | |                   |                           | |           |     | |     |       |   | | | | | | | | 
 |     |   | +---------|-|---|---|---+ |   | | | | | | | |   | |           |       |     |     +-------------------------------------------------|-|---+       |     | |     |       |   | | | | | | | | 
 |     |   | | | | |   | |   |   |   | |   | | | | | | | |   | |           |       |     |       |                   |                           | |   |       |     | |     |       |   | | | | | | | | 
 |     |   | | | | |   | |   |   |   | |   | | | | | | | |   | |           |       |     |       |                   |                           | |   |       |     | |     |       |   | | | | | | | | 
 |     |   | | | | |   | |   |   |   | |   | | | | | | | |   | |           |       |     |       |                   |                           | |   |       |     | |     |       |   | | | | | | | | 
 |     |   | +-----|-------------|---|-|-----------|-|-------|-|-----------|-------|-----|---------------------------|---------------------------|-|---|-------|-------------|-----+ | +-+ | | | | | | | 
 |     |   |   | | |   | |   |   |   | |   | | | | | | | |   | |           |       |     |       |                   |                           | |   |       |     | |     |     | | |   | | | | | | | 
 |     |   +-------|-----|---|---|-----|-----|---------|-------|---------------+   +-----|-------|-+                 |                           | |   |       |     +-------------|-|---+ | | | | | | | 
 |     |       | | |   | |   |   |   | |   | | | | | | | |   | |           |   |         |       | |                 |                           | |   |       |       |     |     | | | | | | | | | | | 
 |     |       | | |   +---------|---|-----|---|-|-|-|-------|-|---------------|---------|-------|-|-----------------|-------------------------+ | |   |       |       |     |     +-|-+ | +-|---+ | | | 
 |     |       | | |     |   |   |   | |   | | | | | | | |   | |           |   |         |       | |                 |                         | | |   |       |       |     |       |   |   | |   | | | 
 |     |       +-|-|---+ |   |   |   | |   | | +-|-|-|---------|-----------|-------------|-----------------------------------------------------+ | |   |       |       |     |       |   |   | | +---+ | 
 |     |         | |   | |   |   |   | |   | |   | | | | |   | |           |   |         |       | |                 |                           | |   |       |       |     |       |   |   | | | |   | 
 |     |     +---|-|-----|-------------|-----|---|-----+ |   | |           |   |         |       | |                 |                           | |   |       |       |     |       |   |   | | | |   | 
 |     |     |   | |   | |   |   |   | |   | |   | | |   |   | |           |   |         |       | |                 |                           | |   |       |       |     |       |   |   | | | |   | 
 +-----|-----------------|-------|---+ +-------+ +-|-----|-----------------|---------------------|-|---------------------------------------------|-|---|-------|-------|-----|---+   |   |   | | | |   | 
       |     |   | |   | |   |   |         | | |   | |   |   | |           |   |         |       | |                 |                           | |   |       |       |     |   |   |   |   | | | |   | 
       |     |   | |   | |   |   +-----------|-------|-------|-|-------------------------|-------|-|-----------------|---------------------------|-----|-------|-------|---------|---|---------|-|-+   | 
       |     |   | |   | |   |             | | |   | |   |   | |           |   |         |       | |                 |                           | |   |       |       |     |   |   |   |   | | |     | 
       |     |   | |   | |   |             | | |   | |   |   | |           |   |         |       | |                 |                           | |   |       |       |     |   |   |   |   | +-----+ | 
       |     |   | |   | |   |             | | |   | |   |   | |           |   |         |       | |                 |                           | |   |       |       |     |   |   |   |   |   |   | | 
       |     |   | |   | |   |             | | |   | |   |   | |           |   |         |       | |                 |                         +-+ |   |       |       |     |   |   |   |   |   |   | | 
       |     |   | |   | |   |             | | |   | |   |   | |           |   |         |       | |                 |                         |   |   |       |       |     |   |   |   |   |   |   | | 
       |     |   | |   | |   |   +---------|-|-----------|---+ +-----------|---|---------+       +-----------------------------------------------------|---------------------------------|---|-------+ | 
       |     |   | |   | |   |   |         | | |   | |   |                 |   |                   |                 |                         |   |   |       |       |     |   |   |   |   |   |     | 
       |     |   | |   | |   |   +-------------|-+ +-----+ +-------------------+                   |           +-----|-+                       |   |   |       |       |     |   |   |   |   |   |     | 
       |     |   | |   | |   |             | | | |   |     |               |                       |           |     | |                       |   |   |       |       |     |   |   |   |   |   |     | 
       |     |   | |   +-----------------------------|---------------------------------------------|-----------|-----------------------------------|-----------+       |     |   |   |   |   |   |     | 
       |     |   | |     |   |             | | | |   |     |               |                       |           |     | |                       |   |   |               |     |   |   |   |   |   |     | 
       |     |   | |     |   |     +-------|-|-|-----------+               +-----------------------------------|-----+ |                       |   |   +-+             |     |   |   |   |   |   |     | 
       |     |   | |     |   |     |       | | | |   |                                             |           |       |                       |   |     |             |     |   |   |   |   |   |     | 
       +-----|---+ |     |   +-------------|-------------------------------------------------------+           |       |       +---------------|---|-----|-------------|-----|---------------|---------+ 
             |     |     |         |       | | | |   |                                                         |       |       |               |   |     |             |     |   |   |   |   |   |       
             +---------------------|-------|---|-----|-----------------------------------------------------------------|-------+               |   |     +-------------+     |   | +-|---+   |   |       
                   |     |         |       | | | |   |                                                         |       |                       |   |                         |   | | |       |   |       
       +---+       |   +-|---------+       +-|---|---+                                                         |       +---------------------------+                         |   | | |       |   |       
       |   |       |   | |                   | | |                                                             |                               |                             |   | | |       |   |       
       |   |       +---|-|-------------------|---------------+                                                 |                       +-------|-----------------------------|---|---|-------|---+       
       |   |           | |                   | | |           |                                                 |                       |       |                             |   | | |       |           
       +---------------+ |                   +-+ +-----------+                                                 |                       +-------+                             |   | | |       |           
           |             |                                                                                     |                                                             |   | | |       |           
           +-----------+ +-------------------------------------------------------------------------------------+                                                       +-----+   +-|-+       |           
                       |                                                                                                                                               |           |         |           
                       +-----------------------------------------------------------------------------------------------------------------------------------------------+           +---------+           
                                                                                                                                                                                                         ";


  }
}